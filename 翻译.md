#STROLLING INTO RING-0 via i/o kit drivers 翻译



#目录

**ring-0 via i/o kit**

<img src="http://omh33iho9.bkt.clouddn.com/1.png" width = "500" height = "280" alt="图片名称" align=center />



##动机
ring-0 还是 金钱 需求？

###"黄金时期"
**黑客攻击是非常容易的**

<img src="http://omh33iho9.bkt.clouddn.com/2.png" width = "500" height = "280" alt="图片名称" align=center />

###现在已经改变

内核模式代码执行必须需要。。。？

<img src="http://omh33iho9.bkt.clouddn.com/3.png" width = "500" height = "280" alt="图片名称" align=center />

<img src="http://omh33iho9.bkt.clouddn.com/4.png" width = "500" height = "280" alt="图片名称" align=center />

<img src="http://omh33iho9.bkt.clouddn.com/5.png" width = "500" height = "280" alt="图片名称" align=center />

##I/OKit的理解

###XNU's device driver environment

<img src="http://omh33iho9.bkt.clouddn.com/6.png" width = "500" height = "280" alt="图片名称" align=center />

###user & kernel mode pieces

<img src="http://omh33iho9.bkt.clouddn.com/7.png" width = "500" height = "280" alt="图片名称" align=center />

###I/O Registry

<img src="http://omh33iho9.bkt.clouddn.com/8.png" width = "500" height = "280" alt="图片名称" align=center />

###I/O KIT DRIVER

<img src="http://omh33iho9.bkt.clouddn.com/9.png" width = "500" height = "280" alt="图片名称" align=center />

###'inter-ring' communications

<img src="http://omh33iho9.bkt.clouddn.com/10.png" width = "500" height = "280" alt="图片名称" align=center />

###connecting to a driver (service)

<img src="http://omh33iho9.bkt.clouddn.com/11.png" width = "500" height = "280" alt="图片名称" align=center />

###invoking driver methods

<img src="http://omh33iho9.bkt.clouddn.com/12.png" width = "500" height = "280" alt="图片名称" align=center />

###example driver interface

<img src="http://omh33iho9.bkt.clouddn.com/13.png" width = "500" height = "280" alt="图片名称" align=center />

###IOExternalMethodDispatch struct

<img src="http://omh33iho9.bkt.clouddn.com/14.png" width = "500" height = "280" alt="图片名称" align=center />

###super's externalMethod()

<img src="http://omh33iho9.bkt.clouddn.com/15.png" width = "500" height = "280" alt="图片名称" align=center />

###user 'client' (find/connect)

<img src="http://omh33iho9.bkt.clouddn.com/16.png" width = "500" height = "280" alt="图片名称" align=center />

###user 'client' (send request)

<img src="http://omh33iho9.bkt.clouddn.com/17.png" width = "500" height = "280" alt="图片名称" align=center />

##发现一个IOKit驱动漏洞
目标程序：little snitch v 3.6

<img src="http://omh33iho9.bkt.clouddn.com/18.png" width = "500" height = "280" alt="图片名称" align=center />

<img src="http://omh33iho9.bkt.clouddn.com/19.png" width = "500" height = "280" alt="图片名称" align=center />

###LITTLE SNITCH'S KEXT

<img src="http://omh33iho9.bkt.clouddn.com/20.png" width = "500" height = "280" alt="图片名称" align=center />

###FIND/CONNECT TO LITTLE SNITCH'S KEXT
**service: 'at\_obdev\_LSNKE'**

<img src="http://omh33iho9.bkt.clouddn.com/21.png" width = "500" height = "280" alt="图片名称" align=center />

<img src="http://omh33iho9.bkt.clouddn.com/22.png" width = "500" height = "280" alt="图片名称" align=center />

**'reachable' kernel methods**

<img src="http://omh33iho9.bkt.clouddn.com/23.png" width = "500" height = "280" alt="图片名称" align=center />

<img src="http://omh33iho9.bkt.clouddn.com/24.png" width = "500" height = "280" alt="图片名称" align=center />

<img src="http://omh33iho9.bkt.clouddn.com/25.png" width = "500" height = "280" alt="图片名称" align=center />

<img src="http://omh33iho9.bkt.clouddn.com/26.png" width = "500" height = "280" alt="图片名称" align=center />

<img src="http://omh33iho9.bkt.clouddn.com/27.png" width = "500" height = "280" alt="图片名称" align=center />

<img src="http://omh33iho9.bkt.clouddn.com/28.png" width = "500" height = "280" alt="图片名称" align=center />
##OWNING LITTLE SNITCH

<img src="http://omh33iho9.bkt.clouddn.com/29.png" width = "500" height = "280" alt="图片名称" align=center />

<img src="http://omh33iho9.bkt.clouddn.com/30.png" width = "500" height = "280" alt="图片名称" align=center />

<img src="http://omh33iho9.bkt.clouddn.com/31.png" width = "500" height = "280" alt="图片名称" align=center />

<img src="http://omh33iho9.bkt.clouddn.com/32.png" width = "500" height = "280" alt="图片名称" align=center />

<img src="http://omh33iho9.bkt.clouddn.com/33.png" width = "500" height = "280" alt="图片名称" align=center />

##CONCLUSIONS总结

<img src="http://omh33iho9.bkt.clouddn.com/34.png" width = "500" height = "280" alt="图片名称" align=center />

<img src="http://omh33iho9.bkt.clouddn.com/35.png" width = "500" height = "280" alt="图片名称" align=center />

<img src="http://omh33iho9.bkt.clouddn.com/36.png" width = "500" height = "280" alt="图片名称" align=center />

<img src="http://omh33iho9.bkt.clouddn.com/37.png" width = "500" height = "280" alt="图片名称" align=center />

译者：ruanbonan原文链接：https://googleprojectzero.blogspot.kr/2016/10/taskt-considered-harmful.html  原文作者：lan Beer,Project Zero  微信公众号：看雪iOS安全小组 我们的微博：weibo.com/pediyiosteam 我们的知乎：zhihu.com/people/pediyiosteam加入我们：看雪iOS安全小组成员募集中：http://bbs.pediy.com/showthread.php?t=212949[看雪iOS安全小组]置顶向导集合贴： http://bbs.pediy.com/showthread.php?t=212685



















































